function APICall(e,n,a,t,s){var r=!1;if("characters"!=(e=e.toLowerCase())&&"books"!=e&&"houses"!=e?console.warn("You entered an incorrect value."):(console.info("\r\nQuery called."),console.info("You are querying for: https://www.anapioficeandfire.com/api/"+e+"?page="+n+"&pageSize="+a+t+s),r=!0),1==r)try{var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var e=JSON.parse(l.responseText);null!=e&&(console.info("\r\nWe got the result, now processing...\r\n"),ProcessAPIResult(e,n,s))}},l.open("GET","https://www.anapioficeandfire.com/api/"+e+"?page="+n+"&pageSize="+a+t+s,!0),l.send()}catch(e){console.warn("An error occured here!")}}function QueryRegion(e){all_characters.length=0,ClearElementsChildren(card__wrapper);var n=e.id,a=cultures[n];if(void 0==a)AddObjectsToElement(card__wrapper,"section.card__section > h1{Sorry, we cannot show you characters for this region, as there are none in the API}");else if($QUERY_TYPE="characters",$QUERY_SIZE=50,$QUERY_FILTER="&Culture=",a instanceof Array){times_to_call_api=a.length;for(var t=a.length-1;t>=0;t--){var s=a[t];APICall($QUERY_TYPE,$QUERY_PAGE=1,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER=s)}}else times_to_call_api=1,APICall($QUERY_TYPE,$QUERY_PAGE=1,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER=a)}function ProcessAPIResult(e,n,a){all_characters.push.apply(all_characters,e),console.info("Added "+e.length+" characters."),e.length<$QUERY_SIZE?(console.info("Added all characters of "+a),console.info("\r\n"),console.info(all_characters),times_to_call_api--):(n+=1,console.info("Proceed to page: "+n),APICall($QUERY_TYPE,n,$QUERY_SIZE,$QUERY_FILTER,a)),0==times_to_call_api&&(console.info("\r\n\r\n ----- We have finished our calls, NOW PROCEED!!! ----- \r\n\r\n"),ClearElementsChildren(card__wrapper),UpdateCardsWithCharacters(0,8))}function ClearElementsChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function UpdateCardsWithCharacters(e,n){var a=document.querySelector(".load_more_characters");if(!0===document.body.contains(a)&&max_value>all_characters.length&&AddClass(a,"hidden"),min_value=e,max_value=n,page_size=n-e,console.info("Load from: "+min_value+" untill "+max_value),all_characters.length<=9)t=all_characters;else var t=all_characters.slice(min_value,max_value);all_characters.length>9&&!1===document.body.contains(a)&&(AddObjectsToElement(card__wrapper,"article.card.load_more_characters > section.card__section > h1{Load next page of characters}"),document.querySelector(".load_more_characters").addEventListener("click",function(){8==page_size?UpdateCardsWithCharacters(min_value+page_size,max_value+page_size+1):UpdateCardsWithCharacters(min_value+page_size,max_value+page_size)})),t.forEach(function(e){BuildArticle(e)})}function DOMText(e){return document.createTextNode(e)}function BuildArticle(e){if(i++,""==e.name&&""!=e.aliases[e.aliases.length-1])n="("+e.aliases[e.aliases.length-1]+")";else if(""!=e.name)n=e.name.replace(".","");else var n="Unknown";var a=e.gender,t=e.culture,s=!1;""===e.born&&(e.born="Unknown"),""===e.died&&(e.died="Unknown");var r=e.playedBy[e.playedBy.length-1];""!=e.playedBy[e.playedBy.length-1]&&(s=!0);var l,o=e.born,c=e.died;switch(a){case"Male":l="fa-mars";break;case"Female":l="fa-venus"}AddObjectsToElement(card__wrapper,"article.card.card-"+i);AddObjectsToElement(document.querySelector(".card-"+i),"header.card__header + section.card__section");var d=document.querySelector(".card-"+i+" header.card__header"),_=document.querySelector(".card-"+i+" section.card__section");AddObjectsToElement(d,"span.card__name > h1{"+n+"} + i.fa.fa-pull-right."+l);var u=[["Culture:",t],["Born:",o],["Died:",c]];if(!0===s){var h=["Played By:",r];u.push(h)}for(var m=0;m<u.length;m++){var p=u[m];AddObjectsToElement(_,"span.card__section__line"),AddObjectsToElement(function(e){return document.querySelectorAll(".card-"+i+" span.card__section__line")[e]}(m),"span.pull-left{"+p[0]+"} + span.pull-right{"+p[1]+"}")}}function ToggleClass(e,n,a){a=void 0===a?"":a,e.classList.contains(n)?(RemoveClass(e,n),""!=a&&AddClass(e,a)):(AddClass(e,n),""!=a&&RemoveClass(e,a))}function RemoveClass(e,n){e.classList.remove(n)}function AddClass(e,n){e.classList.add(n)}function ToggleClassOnMultipleElements(e,n){e.forEach(function(e){ToggleClass(e,n)})}function RemoveClassOnMultipleElements(e,n){e.forEach(function(e){RemoveClass(e,n)})}function AddClassOnMultipleElements(e,n){e.forEach(function(e){AddClass(e,n)})}function ResetAllClasses(){RemoveClassOnMultipleElements(all_lands,"land__clicked"),RemoveClassOnMultipleElements(all_continent_parents,"continent__clicked")}function CheckDependencies(e,n){var a=".part_of_"+n.id,t=document.querySelectorAll(a);switch(e){case"mouseover":AddClassOnMultipleElements(t,"land__hovered");break;case"mouseout":RemoveClassOnMultipleElements(t,"land__hovered");break;case"click":ToggleClassOnMultipleElements(t,"land__clicked")}}function ScrollToElement(e){var n=document.querySelector("#"+e).getBBox();console.log(n);var a=document.querySelector(".section__left"),t=n.y,s=n.x;a.scrollTop=t,a.scrollLeft=s,console.log("New position:"),console.log("Horizontal: "+a.scrollLeft+" | Vertical: "+a.scrollTop)}function CreateHTMLObject(e){var n=0,a=0,t="",s="";if(e.includes(".")){var r=e.split(".");s=document.createElement(r[0]);for(var l=1;l<r.length;l++){var o=r[l];o.includes("{")?(n=o.search("{"),a=o.search("}"),t=document.createTextNode(o.substring(n+1,a)),s.classList.add(o.substring(0,n)),s.appendChild(t)):s.classList.add(o.replace(" ",""))}}else!function(e){e.includes("{")&&(n=e.search("{"),a=e.search("}"),t=document.createTextNode(e.substring(n+1,a)),""!=s?s.appendChild(t):(s=document.createElement(e.substring(0,n))).appendChild(t))}(e);return s}function AddObjectsToElement(e,n){var a=e;if(n.includes(" + "))for(var t=n.split(" + "),s=0;s<t.length;s++)AddObjectsToElement(a,t[s]);else for(var r=n.split(" > "),l=0;l<r.length;l++){var o=CreateHTMLObject(r[l]);a.appendChild(o),a=o}}function SearchElement(e,n){function a(n,a){n=n.filter(Boolean),type_number++,t["Number-"+type_number]=0,n.forEach(function(n){n.toLowerCase().includes(e.toLowerCase())&&(t["Number-"+type_number]++,1==t["Number-"+type_number]&&AddObjectsToElement(search_bar_results,"div.search__option__group__title > span{"+a+"}"),AddObjectsToElement(search_bar_results,"span.search__option > span{"+n+"}"))})}n=void 0===n?"":n;var t={};switch(type_number=0,"undefined"!=n&&console.log(e),n){case"region":a(regions,"Regions");break;case"city":a(cities,"Cities");break;case"culture":a(unique_cultures,"Cultures");break;default:a(regions,"Regions"),a(cities,"Cities"),a(unique_cultures,"Cultures")}0==t["Number-1"]&&0==t["Number-2"]&&0==t["Number-3"]&&AddObjectsToElement(search_bar_results,"div.text-warning > span{We did not find anything with that query, please try another or be more specific}")}function ZoomSVG(e){document.querySelector("#game_of_thrones_world_map_svg").style.height=e+"vh"}var $QUERY_TYPE,$QUERY_PAGE,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER,times_to_call_api,all_characters=Array(),card__wrapper=document.querySelector(".card__wrapper"),min_value=0,max_value=0,i=0;console.info("Hello there!"),document.addEventListener("DOMContentLoaded",function(e){all_lands=document.querySelectorAll("[class*=land_]"),all_pins=document.querySelectorAll("[class*=pin_]"),all_titles=document.querySelectorAll("[class*=text_]"),all_continents=document.querySelectorAll(".continent"),all_continent_parents=document.querySelectorAll(".continent_wrapper"),ResetAllClasses(),all_lands.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e,"land__hovered"),CheckDependencies("mouseover",e)}),e.addEventListener("mouseout",function(){RemoveClass(e,"land__hovered"),CheckDependencies("mouseout",e)}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e,"land__clicked"),CheckDependencies("click",e),QueryRegion(e)}),regions.push(e.id.split("_").join(" "))}),all_pins.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e,"pins__hovered")}),e.addEventListener("mouseout",function(){RemoveClass(e,"pins__hovered")}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e,"pins__clicked"),QueryRegion(e)}),cities.push(e.id.split("_").join(" "))}),all_continents.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e.parentElement,"continent__hovered")}),e.addEventListener("mouseout",function(){RemoveClass(e.parentElement,"continent__hovered")}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e.parentElement,"continent__clicked"),QueryRegion(e.parentElement)}),regions.push(e.id.split("_").join(" "))}),function(){var e=document.createElement("div");e.className="scrollbar-measure",document.body.appendChild(e);var n=e.offsetWidth-e.clientWidth;console.info(n),document.body.removeChild(e),document.querySelector(".svg__tools").style.bottom=30+n+"px"}()});var search_bar=document.querySelector(".header__search_bar__input"),search_bar_results=document.querySelector(".header__search_bar__result");search_bar.addEventListener("input",function(e){if(e.target.value.length>2)if(RemoveClass(search_bar_results,"closed"),ClearElementsChildren(search_bar_results),e.target.value.includes(":")){SearchElement(/\:(.*)/g.exec(e.target.value)[1].trim(),/(.+?(?=\:))/g.exec(e.target.value)[1].toLowerCase())}else SearchElement(e.target.value);else AddClass(search_bar_results,"closed")});var toggle_pins_checkbox=document.querySelector("#toggle_pins_checkbox"),toggle_pins_label=toggle_pins_checkbox.nextElementSibling,more_information_label=document.querySelectorAll(".svg__tools__label")[1];toggle_pins_checkbox.addEventListener("change",function(){all_pins.forEach(function(e){e.classList.remove("pins__clicked"),e.classList.contains("pin_shown")?(e.classList.remove("pin_shown"),more_information_label.innerHTML="Click on a region to get more information.",toggle_pins_label.innerHTML="Show cities"):(e.classList.add("pin_shown"),more_information_label.innerHTML="Click on a region/city to get more information.",toggle_pins_label.innerHTML="Hide cities")})});var zoom_slider=document.querySelector("#zoom_svg_slider");zoom_slider.addEventListener("change",function(){ZoomSVG(zoom_slider.value)});var resizer=document.querySelector("#svg__tools__resize"),svg__tools_box=document.querySelector(".svg__tools");resizer.addEventListener("click",function(){ToggleClass(svg__tools_box,"opened","closed"),ToggleClass(resizer,"fa-window-minimize","fa-window-maximize")});var all_lands,all_continents,all_titles,all_pins,all_characters=Array(),cultures={Braavos:"Braavosi",Westeros:["Westeros","Andal","First Men","Rhoynar"],Kings_Landing:"Westeros",Valyria:"Valyrian",The_Stormlands:"Stormlands",The_Iron_Islands:"Ironborn",The_North:["Northmen","Northern mountain clans"],The_Vale:["Valemen","Mountain clans"],The_Reach:"Reach",Dorne:"Dornish",Riverlands:"Rivermen",Westernlands:["Westerman","Westerlands"],The_Three_Sisters:"Sistermen",New_Ghis:"Ghiscari",Old_Ghis:"Ghiscari",The_Neck:"Crannogmen",Asshai:"Asshai",Tyrish:"Tyroshi",Myr:"Myrish",Thenn:"Thenn",The_Land_of_Always_Winter:"Free Folk",Vaes_Dothrak:"Dothraki",Norvos:"Norvoshi",Ib_Islands:"Ibbenese",Summer_Islands:"Summer Isles",Meereen:"Meereenese",Astapor:"Astapori",Lys:"Lysene",Qarth:"Qartheen",Lhazosh:"Lhazareen",Pentos:"Pentoshi",Naath:"Naathi",Qohor:"Qohor"},cities=[],regions=[],unique_cultures=[];Object.keys(cultures).forEach(function(e){var n=cultures[e];if(n instanceof Array)for(var a=0;a<n.length;a++){var t=n[a];0==unique_cultures.includes(t)&&unique_cultures.push(t)}else 0==unique_cultures.includes(n)&&unique_cultures.push(n)});