function APICall(e,a,n,t,r){var s=!1;if("characters"!=(e=e.toLowerCase())&&"books"!=e&&"houses"!=e&&""!=r&&void 0!=r&&null!=r?console.warn("Please enter a value to query."):(console.info("\r\nQuery called."),console.info("You are querying for: https://www.anapioficeandfire.com/api/"+e+"?page="+a+"&pageSize="+n+t+r),s=!0),1==s)try{var l=new XMLHttpRequest;l.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var s=JSON.parse(l.responseText);null!=s&&(console.info("\r\nWe got the result, now processing...\r\n"),ProcessAPIResult(s,e,a,n,t,r))}},l.open("GET","https://www.anapioficeandfire.com/api/"+e+"?page="+a+"&pageSize="+n+t+r,!0),l.send()}catch(e){console.warn("An error occured here!")}}function QueryRegion(e,a){if(a=void 0===a?"":a,all_characters.length=0,ClearElementsChildren(card__wrapper),""===a)var n=e.id,t=cultures[n];else t=e;if(void 0==t)AddObjectsToElement(card__wrapper,"section.card__section > h1{Sorry, we cannot show you characters for this region, as there are none in the API}");else if($QUERY_TYPE="characters",$QUERY_SIZE=50,$QUERY_FILTER="&Culture=",t instanceof Array){times_to_call_api=t.length;for(var r=t.length-1;r>=0;r--){var s=t[r];APICall($QUERY_TYPE,$QUERY_PAGE=1,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER=s)}}else times_to_call_api=1,APICall($QUERY_TYPE,$QUERY_PAGE=1,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER=t)}function ProcessAPIResult(e,a,n,t,r,s){all_characters.push.apply(all_characters,e),console.info("Added "+e.length+" characters."),e.length<t?(console.info("Added all characters of "+s),console.info("\r\n"),console.info(all_characters),times_to_call_api--):(n+=1,console.info("Proceed to page: "+n),APICall(a,n,t,r,s)),0==times_to_call_api&&(console.info("\r\n\r\n ----- We have finished our calls, NOW PROCEED!!! ----- \r\n\r\n"),ClearElementsChildren(card__wrapper),UpdateCardsWithCharacters(0,8))}function ClearElementsChildren(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function UpdateCardsWithCharacters(e,a){if(0==all_characters.length?(ClearElementsChildren(search_bar_results),AddObjectsToElement(search_bar_results,"i.fa.fa-exclamation-circle.fa-4x + span{We did not find any character with that name!}")):RemoveClass(search_bar_results,"opened"),min_value=e,max_value=a,page_size=a-e,console.info("Load from: "+min_value+" untill "+max_value),all_characters.length<=9)n=all_characters;else var n=all_characters.slice(min_value,max_value);if(all_characters.length>9&&!1===document.body.contains(document.querySelector(".load_more_characters"))){AddObjectsToElement(card__wrapper,"article.card.load_more_characters > section.card__section > h1{Load next page of characters}");document.querySelector(".load_more_characters").addEventListener("click",function(){8==page_size?UpdateCardsWithCharacters(min_value+page_size,max_value+page_size+1):UpdateCardsWithCharacters(min_value+page_size,max_value+page_size)})}max_value>=all_characters.length&&!0===document.body.contains(document.querySelector(".load_more_characters"))&&AddClass(document.querySelector(".load_more_characters"),"hidden"),n.forEach(function(e){BuildArticle(e)})}function BuildArticle(e){if(i++,""==e.name&&""!=e.aliases[e.aliases.length-1])a="("+e.aliases[e.aliases.length-1]+")";else if(""!=e.name)a=e.name.replace(".","");else var a="Unknown character";var n=e.gender;if(""===e.culture)t="Unknown";else var t=e.culture;var r=!1;""===e.born&&(e.born="Unknown"),""===e.died&&(e.died="Unknown");var s=e.playedBy[e.playedBy.length-1];""!=e.playedBy[e.playedBy.length-1]&&(r=!0);var l,o=e.born.split(".").join(" ").trim(),c=e.died.split(".").join(" ").trim();switch(n){case"Male":l="fa-mars";break;case"Female":l="fa-venus"}AddObjectsToElement(card__wrapper,"article.card.card-"+i);AddObjectsToElement(document.querySelector(".card-"+i),"header.card__header + section.card__section");var d=document.querySelector(".card-"+i+" header.card__header"),u=document.querySelector(".card-"+i+" section.card__section");AddObjectsToElement(d,"span.card__name > h1{"+a+"} + i.fa.fa-pull-right."+l);var _=[["Culture:",t],["Born:",o],["Died:",c]];if(!0===r){var h=["Played By:",s];_.push(h)}for(var m=0;m<_.length;m++){var p=_[m];AddObjectsToElement(u,"span.card__section__line"),AddObjectsToElement(function(e){return document.querySelectorAll(".card-"+i+" span.card__section__line")[e]}(m),"span.pull-left{"+p[0]+"} + span.pull-right{"+p[1]+"}")}}function MeasureScrollBar(){var e=document.createElement("div");e.className="scrollbar-measure",document.body.appendChild(e);var a=e.offsetWidth-e.clientWidth;document.body.removeChild(e);var n=document.querySelector(".svg__tools"),t=document.querySelector(".footer").clientHeight;window.innerWidth<=1068?n.style.bottom=t+"px":n.style.bottom=t+a+"px"}function ToggleClass(e,a,n){n=void 0===n?"":n,e.classList.contains(a)?(RemoveClass(e,a),""!=n&&AddClass(e,n)):(AddClass(e,a),""!=n&&RemoveClass(e,n))}function RemoveClass(e,a){e.classList.remove(a)}function AddClass(e,a){e.classList.add(a)}function ToggleClassOnMultipleElements(e,a){e.forEach(function(e){ToggleClass(e,a)})}function RemoveClassOnMultipleElements(e,a){e.forEach(function(e){RemoveClass(e,a)})}function AddClassOnMultipleElements(e,a){e.forEach(function(e){AddClass(e,a)})}function ResetAllClasses(){RemoveClassOnMultipleElements(all_lands,"land__clicked"),RemoveClassOnMultipleElements(all_continent_parents,"continent__clicked")}function CheckDependencies(e,a){var n=".part_of_"+a.id,t=document.querySelectorAll(n);switch(e){case"mouseover":AddClassOnMultipleElements(t,"land__hovered");break;case"mouseout":RemoveClassOnMultipleElements(t,"land__hovered");break;case"click":ToggleClassOnMultipleElements(t,"land__clicked")}}function ScrollToElement(e){var a=document.querySelector("#"+e).getBBox();console.log(a);var n=document.querySelector(".section__left"),t=a.y,r=a.x;n.scrollTop=t,n.scrollLeft=r,console.log("New position:"),console.log("Horizontal: "+n.scrollLeft+" | Vertical: "+n.scrollTop)}function CreateHTMLObject(e){var a=0,n=0,t="",r="";if(e.includes(".")){var s=e.split(".");r=document.createElement(s[0]);for(var l=1;l<s.length;l++){var o=s[l];o.includes("{")?(a=o.search("{"),n=o.search("}"),t=document.createTextNode(o.substring(a+1,n).split("&DOT;").join(".")),r.classList.add(o.substring(0,a)),r.appendChild(t)):r.classList.add(o.replace(" ",""))}}else!function(e){e.includes("{")&&(a=e.search("{"),n=e.search("}"),t=document.createTextNode(e.substring(a+1,n).split("&DOT;").join(".")),""!=r?r.appendChild(t):(r=document.createElement(e.substring(0,a))).appendChild(t))}(e);return r}function AddObjectsToElement(e,a){var n=e;if(a.includes(" + "))for(var t=a.split(" + "),r=0;r<t.length;r++)AddObjectsToElement(n,t[r]);else for(var s=a.split(" > "),l=0;l<s.length;l++){var o=CreateHTMLObject(s[l]);n.appendChild(o),n=o}}function SearchElement(e,a){function n(a,n){type_number++,t["Number-"+type_number]=0,a.forEach(function(a){a.toLowerCase().includes(e.toLowerCase())&&(t["Number-"+type_number]++,1==t["Number-"+type_number]&&AddObjectsToElement(search_bar_results,"div.search__option__group__title > span{"+n+"}"),AddObjectsToElement(search_bar_results,"span.search__option."+n+"{"+a+"}"),addEventsToSearchOptions())})}a=void 0===a?"":a;var t={};switch(type_number=0,a){case"region":case"regions":case"reg":n(regions,"Regions");break;case"city":case"cities":n(cities,"Cities");break;case"culture":case"cultures":case"cult":n(unique_cultures,"Cultures");break;case"character":case"char":case"person":AddObjectsToElement(search_bar_results,"i.fa.fa-spinner.fa-pulse.fa-4x + span{Please wait while we search that character&DOT;&DOT;&DOT;}"),null!=globalTimeout&&clearTimeout(globalTimeout),globalTimeout=setTimeout(function(){""!=e?(console.log("We can continue now ..."),times_to_call_api=1,all_characters.length=0,APICall("characters",0,50,"&Name=",e)):console.log("Waiting for a value to be entered")},500);break;default:n(regions,"Regions"),n(cities,"Cities"),n(unique_cultures,"Cultures")}0==t["Number-1"]&&0==t["Number-2"]&&0==t["Number-3"]&&AddObjectsToElement(search_bar_results,"div.text-warning > span{We did not find anything with that query&DOT; Please try something else or be more specific&DOT;}")}function SetSearchbarValue(e,a){a=a.split("_").join(" "),search_bar.value=e+a}function addEventsToSearchOptions(){search_bar_results.addEventListener("click",function(e){if(e.stopImmediatePropagation(),e.cancelBubble=!0,e.target&&e.target.classList.contains("search__option")){var a=e.target.innerHTML,n=a.split(" ").join("_"),t=e.target.classList[e.target.classList.length-1],r=document.querySelector("#"+n);switch(HideAllCities(),ResetAllClasses(),t){case"Regions":ToggleClass(r,"land__clicked"),CheckDependencies("click",r),QueryRegion(r);break;case"Cities":ToggleClass(r,"pins__clicked"),QueryRegion(r);break;case"Cultures":QueryRegion(a,"culture")}RemoveClass(search_bar_results,"opened"),SetSearchbarValue(t+": ",a)}else e.target&&console.log(e.target)})}function HideAllCities(){all_pins.forEach(function(e){RemoveClass(e,"pins__clicked")})}function ZoomSVG(e){document.querySelector("#game_of_thrones_world_map_svg").style.height=e+"vh"}var $QUERY_TYPE,$QUERY_PAGE,$QUERY_SIZE,$QUERY_FILTER,$QUERY_PARAMETER,times_to_call_api,all_characters=Array(),card__wrapper=document.querySelector(".card__wrapper"),min_value=0,max_value=0,i=0;console.info("Hello there!"),document.addEventListener("DOMContentLoaded",function(e){/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(document.querySelectorAll(".svg__tools__label")[0].style.display="none"),all_lands=document.querySelectorAll("[class*=land_]"),all_pins=document.querySelectorAll("[class*=pin_]"),all_titles=document.querySelectorAll("[class*=text_]"),all_continents=document.querySelectorAll(".continent"),all_continent_parents=document.querySelectorAll(".continent_wrapper"),ResetAllClasses(),all_lands.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e,"land__hovered"),CheckDependencies("mouseover",e)}),e.addEventListener("mouseout",function(){RemoveClass(e,"land__hovered"),CheckDependencies("mouseout",e)}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e,"land__clicked"),CheckDependencies("click",e),QueryRegion(e),SetSearchbarValue("Region: ",e.id)}),regions.push(e.id.split("_").join(" "))}),all_pins.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e,"pins__hovered")}),e.addEventListener("mouseout",function(){RemoveClass(e,"pins__hovered")}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e,"pins__clicked"),QueryRegion(e),SetSearchbarValue("City: ",e.id)}),cities.push(e.id.split("_").join(" "))}),all_continents.forEach(function(e){e.addEventListener("mouseover",function(){AddClass(e.parentElement,"continent__hovered")}),e.addEventListener("mouseout",function(){RemoveClass(e.parentElement,"continent__hovered")}),e.addEventListener("click",function(){ResetAllClasses(),ToggleClass(e.parentElement,"continent__clicked"),QueryRegion(e.parentElement),SetSearchbarValue("Region: ",e.parentElement.id)}),regions.push(e.parentElement.id.split("_").join(" "))}),MeasureScrollBar(),window.addEventListener("resize",function(){console.log("Resizing"),MeasureScrollBar()})});var search_bar=document.querySelector(".header__search_bar__input"),search_bar_results=document.querySelector(".header__search_bar__result"),globalTimeout=null,header_title=document.querySelector(".header__title"),header__search_bar=document.querySelector(".header__search_bar");document.addEventListener("DOMContentLoaded",function(){header__search_bar.addEventListener("click",function(){window.outerWidth<=535&&(AddClass(header__search_bar,"search_bar_opened"),AddClass(header_title,"hidden"))})}),search_bar.addEventListener("input",function(e){if(0==e.target.value.length&&(RemoveClass(search_bar_results,"opened"),RemoveClass(header_title,"hidden")),e.target.value.length>1)if(window.outerWidth<=675&&(console.log("Resetting font-size"),AddClass(header_title,"hidden")),AddClass(search_bar_results,"opened"),ClearElementsChildren(search_bar_results),e.target.value.includes(":")){SearchElement(/\:(.*)/g.exec(e.target.value)[1].trim(),/(.+?(?=\:))/g.exec(e.target.value)[1].toLowerCase())}else SearchElement(e.target.value)});var toggle_pins_checkbox=document.querySelector("#toggle_pins_checkbox"),toggle_pins_label=toggle_pins_checkbox.nextElementSibling,more_information_label=document.querySelectorAll(".svg__tools__label")[1];toggle_pins_checkbox.addEventListener("change",function(){all_pins.forEach(function(e){RemoveClass(e,"pins__clicked"),e.classList.contains("pin_shown")?(RemoveClass(e,"pin_shown"),more_information_label.innerHTML="Click on a region to get more information.",toggle_pins_label.innerHTML="Show cities"):(AddClass(e,"pin_shown"),more_information_label.innerHTML="Click on a region/city to get more information.",toggle_pins_label.innerHTML="Hide cities")})});var zoom_slider=document.querySelector("#zoom_svg_slider");zoom_slider.addEventListener("change",function(){ZoomSVG(zoom_slider.value)});var resizer=document.querySelector("#svg__tools__resize"),svg__tools_box=document.querySelector(".svg__tools");resizer.addEventListener("click",function(){ToggleClass(svg__tools_box,"opened","closed"),ToggleClass(resizer,"fa-window-minimize","fa-window-maximize")});var all_lands,all_continents,all_titles,all_pins,all_characters=Array(),cultures={Braavos:"Braavosi",Westeros:["Westeros","Andal","First Men","Rhoynar"],Kings_Landing:"Westeros",Valyria:"Valyrian",The_Stormlands:"Stormlands",The_Iron_Islands:"Ironborn",The_North:["Northmen","Northern mountain clans","Crannogmen"],The_Vale:["Valemen","Mountain clans","Sistermen"],The_Reach:"Reach",Dorne:"Dornish",Riverlands:"Rivermen",Westernlands:["Westerman","Westerlands"],The_Three_Sisters:"Sistermen",New_Ghis:"Ghiscari",Old_Ghis:"Ghiscari",The_Neck:"Crannogmen",Asshai:"Asshai",Tyrosh:"Tyroshi",Myr:"Myrish",Thenn:"Thenn",The_Land_of_Always_Winter:["Free Folk","Thenn"],Vaes_Dothrak:"Dothraki",Norvos:"Norvoshi",Ib_Islands:"Ibbenese",Summer_Islands:"Summer Isles",Meereen:"Meereenese",Astapor:"Astapori",Lys:"Lysene",Qarth:"Qartheen",Lhazosh:"Lhazareen",Pentos:"Pentoshi",Naath:"Naathi",Qohor:"Qohor"},cities=[],regions=[],unique_cultures=[];Object.keys(cultures).forEach(function(e){var a=cultures[e];if(a instanceof Array)for(var n=0;n<a.length;n++){var t=a[n];0==unique_cultures.includes(t)&&unique_cultures.push(t)}else 0==unique_cultures.includes(a)&&unique_cultures.push(a)});